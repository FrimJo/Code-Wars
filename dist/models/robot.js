"use strict";
const path = '../users/';
class Robot {
    constructor(id) {
        this.id = id;
        this._x = 120;
        this._y = 120;
        this._numActionsLeft = 2;
        this._startPosition = { x: this._x, y: this._y };
        // Move sped equals distance traveled over one second, speed = 1 => 1px per second
        this._angularSpeed = 0;
        // Rotate sped equals degrees turned over one second, speed = 1 => 1degree per second
        this._linearSpeed = 0;
        // Direction is represented in degrees
        this._direction = 0;
        this._radius = 0;
        this._delta = 0;
        console.log('new robot');
        let url = path + id;
        // Clears the cache of this robot
        delete require.cache[require.resolve(url)];
        // Aquire the new file
        this._require = require(url);
        if (!this._require) {
            throw 'No file detected';
        }
        else {
            // Initiate the robot with start values
            this._require.init(this);
        }
    }
    // Delta is the time pased since last tick
    run(delta) {
        // Reset actions
        this._numActionsLeft = 2;
        // Run script code
        this._require.run(this);
        this._delta += delta;
        let deltaPosition = this.calculatePosition();
        // Run the delta position through a rotation matrix based of direction
        this._x = this._startPosition.x + deltaPosition.x;
        this._y = this._startPosition.y + deltaPosition.y;
        //console.log('(robot)this.position.x: ' + this.position.x + ', this.position.y: ' + this.position.y)
    }
    update() {
        this._numActionsLeft--;
        console.log('update()');
        let angularSpeed = this._angularSpeed == 0 ? 1 : this._angularSpeed;
        this._radius = this._linearSpeed / angularSpeed;
        this._delta = 0;
        this._startPosition = { x: this._x, y: this._y };
    }
    calculatePosition() {
        let angle = this._angularSpeed * this._delta;
        console.log(angle);
        let dx = this._radius - this._radius * Math.cos(angle);
        let dy = this._radius * Math.sin(angle);
        return { x: dx, y: dy };
    }
    get position() {
        return { x: this._x, y: this._y };
    }
    set position(position) {
        this._x = position.x;
        this._y = position.y;
    }
    set direction(direction) {
        if (this._numActionsLeft <= 0)
            return;
        direction = direction > 360.0 ? direction - 360.0 : direction;
        this._direction = this.degreesToRadians(direction);
    }
    // Degrees per second
    set angularSpeed(speed) {
        if (this._numActionsLeft <= 0)
            return;
        speed = speed > 360.0 ? speed - 360.0 : speed;
        this._angularSpeed = this.degreesToRadians(speed);
        this.update();
    }
    get angularSpeed() {
        return this._angularSpeed;
    }
    // pixels per second
    set linearSpeed(speed) {
        this._linearSpeed = speed;
        this.update();
    }
    get linearSpeed() {
        return this._linearSpeed;
    }
    degreesToRadians(degree) {
        return degree * Math.PI / 180.0;
    }
}
module.exports = Robot;

//# sourceMappingURL=data:application/json;base64,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LENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUVqRCxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUE7SUFDZCxDQUFDO0lBRUQsSUFBVyxZQUFZO1FBQ3RCLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFBO0lBQzFCLENBQUM7SUFFRCxvQkFBb0I7SUFDcEIsSUFBVyxXQUFXLENBQUMsS0FBYTtRQUNuQyxJQUFJLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQTtRQUN6QixJQUFJLENBQUMsTUFBTSxFQUFFLENBQUE7SUFDZCxDQUFDO0lBRUQsSUFBVyxXQUFXO1FBQ3JCLE1BQU0sQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFBO0lBQ3pCLENBQUM7SUFFTyxnQkFBZ0IsQ0FBQyxNQUFNO1FBQzlCLE1BQU0sQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxLQUFLLENBQUE7SUFDaEMsQ0FBQztBQUNGLENBQUM7QUFFRCxpQkFBUyxLQUFLLENBQUEiLCJmaWxlIjoibW9kZWxzL3JvYm90LmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcGF0aDogc3RyaW5nID0gJy4uL3VzZXJzLydcblxuY2xhc3MgUm9ib3Qge1xuXG5cdHByaXZhdGUgX3g6IG51bWJlciA9IDEyMFxuXHRwcml2YXRlIF95OiBudW1iZXIgPSAxMjBcblxuXHRwcml2YXRlIF9udW1BY3Rpb25zTGVmdDpudW1iZXIgPSAyXG5cblx0cHJpdmF0ZSBfc3RhcnRQb3NpdGlvbiA9IHt4OiB0aGlzLl94LCB5OiB0aGlzLl95fVxuXG5cdC8vIE1vdmUgc3BlZCBlcXVhbHMgZGlzdGFuY2UgdHJhdmVsZWQgb3ZlciBvbmUgc2Vjb25kLCBzcGVlZCA9IDEgPT4gMXB4IHBlciBzZWNvbmRcblx0cHJpdmF0ZSBfYW5ndWxhclNwZWVkOiBudW1iZXIgPSAwXG5cblx0Ly8gUm90YXRlIHNwZWQgZXF1YWxzIGRlZ3JlZXMgdHVybmVkIG92ZXIgb25lIHNlY29uZCwgc3BlZWQgPSAxID0+IDFkZWdyZWUgcGVyIHNlY29uZFxuXHRwcml2YXRlIF9saW5lYXJTcGVlZDogbnVtYmVyID0gMFxuXG5cdC8vIERpcmVjdGlvbiBpcyByZXByZXNlbnRlZCBpbiBkZWdyZWVzXG5cdHByaXZhdGUgX2RpcmVjdGlvbjogbnVtYmVyID0gMFxuXG5cdHByaXZhdGUgX3JhZGl1czogbnVtYmVyID0gMFxuXHRwcml2YXRlIF9kZWx0YTogbnVtYmVyID0gMFxuXG5cdHByaXZhdGUgX3JlcXVpcmVcblxuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIGlkOiBzdHJpbmcpe1xuXHRcdGNvbnNvbGUubG9nKCduZXcgcm9ib3QnKVxuXHRcdGxldCB1cmwgPSBwYXRoICsgaWRcblxuXHRcdC8vIENsZWFycyB0aGUgY2FjaGUgb2YgdGhpcyByb2JvdFxuXHRcdGRlbGV0ZSByZXF1aXJlLmNhY2hlW3JlcXVpcmUucmVzb2x2ZSh1cmwpXVxuXG5cdFx0Ly8gQXF1aXJlIHRoZSBuZXcgZmlsZVxuXHRcdHRoaXMuX3JlcXVpcmUgPSByZXF1aXJlKHVybCk7XG5cblx0XHRpZighdGhpcy5fcmVxdWlyZSl7XG5cblx0XHRcdHRocm93ICdObyBmaWxlIGRldGVjdGVkJ1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0Ly8gSW5pdGlhdGUgdGhlIHJvYm90IHdpdGggc3RhcnQgdmFsdWVzXG5cdFx0XHR0aGlzLl9yZXF1aXJlLmluaXQodGhpcylcblx0XHR9XG5cdH1cblxuXHQvLyBEZWx0YSBpcyB0aGUgdGltZSBwYXNlZCBzaW5jZSBsYXN0IHRpY2tcblx0cHVibGljIHJ1bihkZWx0YSl7XG5cblx0XHQvLyBSZXNldCBhY3Rpb25zXG5cdFx0dGhpcy5fbnVtQWN0aW9uc0xlZnQgPSAyXG5cblx0XHQvLyBSdW4gc2NyaXB0IGNvZGVcblx0XHR0aGlzLl9yZXF1aXJlLnJ1bih0aGlzKVxuXG5cdFx0dGhpcy5fZGVsdGEgKz0gZGVsdGFcblxuXHRcdGxldCBkZWx0YVBvc2l0aW9uID0gdGhpcy5jYWxjdWxhdGVQb3NpdGlvbigpXG5cblx0XHQvLyBSdW4gdGhlIGRlbHRhIHBvc2l0aW9uIHRocm91Z2ggYSByb3RhdGlvbiBtYXRyaXggYmFzZWQgb2YgZGlyZWN0aW9uXG5cblx0XHR0aGlzLl94ID0gdGhpcy5fc3RhcnRQb3NpdGlvbi54ICsgZGVsdGFQb3NpdGlvbi54XG5cdFx0dGhpcy5feSA9IHRoaXMuX3N0YXJ0UG9zaXRpb24ueSArIGRlbHRhUG9zaXRpb24ueVxuXG5cdFx0Ly9jb25zb2xlLmxvZygnKHJvYm90KXRoaXMucG9zaXRpb24ueDogJyArIHRoaXMucG9zaXRpb24ueCArICcsIHRoaXMucG9zaXRpb24ueTogJyArIHRoaXMucG9zaXRpb24ueSlcblxuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGUoKXtcblx0XHR0aGlzLl9udW1BY3Rpb25zTGVmdC0tXG5cblx0XHRjb25zb2xlLmxvZygndXBkYXRlKCknKVxuXHRcdGxldCBhbmd1bGFyU3BlZWQgPSB0aGlzLl9hbmd1bGFyU3BlZWQgPT0gMCA/IDEgOiB0aGlzLl9hbmd1bGFyU3BlZWRcblxuXHRcdHRoaXMuX3JhZGl1cyA9IHRoaXMuX2xpbmVhclNwZWVkIC8gYW5ndWxhclNwZWVkXG5cblx0XHR0aGlzLl9kZWx0YSA9IDBcblxuXHRcdHRoaXMuX3N0YXJ0UG9zaXRpb24gPSB7eDogdGhpcy5feCwgeTogdGhpcy5feX1cblxuXHR9XG5cblx0cHJpdmF0ZSBjYWxjdWxhdGVQb3NpdGlvbigpIHtcblxuXHRcdGxldCBhbmdsZSA9IHRoaXMuX2FuZ3VsYXJTcGVlZCAqIHRoaXMuX2RlbHRhXG5cdFx0Y29uc29sZS5sb2coYW5nbGUpXG5cdFx0bGV0IGR4ID0gdGhpcy5fcmFkaXVzIC0gdGhpcy5fcmFkaXVzICogTWF0aC5jb3MoYW5nbGUpXG5cdFx0bGV0IGR5ID0gdGhpcy5fcmFkaXVzICogTWF0aC5zaW4oYW5nbGUpXG5cblx0XHRyZXR1cm4ge3g6IGR4LCB5OiBkeX1cblx0fVxuXG5cdHB1YmxpYyBnZXQgcG9zaXRpb24oKXtcblxuXHRcdHJldHVybiB7eDogdGhpcy5feCwgeTogdGhpcy5feX1cblx0fVxuXG5cdHB1YmxpYyBzZXQgcG9zaXRpb24ocG9zaXRpb24pIHtcblx0XHR0aGlzLl94ID0gcG9zaXRpb24ueFxuXHRcdHRoaXMuX3kgPSBwb3NpdGlvbi55XG5cdH1cblxuXHRwcml2YXRlIHNldCBkaXJlY3Rpb24oZGlyZWN0aW9uOiBudW1iZXIpIHtcblx0XHRpZiAodGhpcy5fbnVtQWN0aW9uc0xlZnQgPD0gMCkgcmV0dXJuXG5cblx0XHRkaXJlY3Rpb24gPSBkaXJlY3Rpb24gPiAzNjAuMD8gZGlyZWN0aW9uIC0gMzYwLjAgOiBkaXJlY3Rpb25cblx0XHR0aGlzLl9kaXJlY3Rpb24gPSB0aGlzLmRlZ3JlZXNUb1JhZGlhbnMoZGlyZWN0aW9uKVxuXHR9XG5cblx0Ly8gRGVncmVlcyBwZXIgc2Vjb25kXG5cdHB1YmxpYyBzZXQgYW5ndWxhclNwZWVkKHNwZWVkOiBudW1iZXIpe1xuXHRcdGlmICh0aGlzLl9udW1BY3Rpb25zTGVmdCA8PSAwKSByZXR1cm5cblxuXHRcdHNwZWVkID0gc3BlZWQgPiAzNjAuMD8gc3BlZWQgLSAzNjAuMCA6IHNwZWVkXG5cdFx0dGhpcy5fYW5ndWxhclNwZWVkID0gdGhpcy5kZWdyZWVzVG9SYWRpYW5zKHNwZWVkKVxuXG5cdFx0dGhpcy51cGRhdGUoKVxuXHR9XG5cblx0cHVibGljIGdldCBhbmd1bGFyU3BlZWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX2FuZ3VsYXJTcGVlZFxuXHR9XG5cblx0Ly8gcGl4ZWxzIHBlciBzZWNvbmRcblx0cHVibGljIHNldCBsaW5lYXJTcGVlZChzcGVlZDogbnVtYmVyKXtcblx0XHR0aGlzLl9saW5lYXJTcGVlZCA9IHNwZWVkXG5cdFx0dGhpcy51cGRhdGUoKVxuXHR9XG5cblx0cHVibGljIGdldCBsaW5lYXJTcGVlZCgpIHtcblx0XHRyZXR1cm4gdGhpcy5fbGluZWFyU3BlZWRcblx0fVxuXG5cdHByaXZhdGUgZGVncmVlc1RvUmFkaWFucyhkZWdyZWUpIHtcblx0XHRyZXR1cm4gZGVncmVlICogTWF0aC5QSSAvIDE4MC4wXG5cdH1cbn1cblxuZXhwb3J0ID0gUm9ib3QiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
